-- 修复课程模板表结构和数据
SET NAMES utf8mb4;

-- 确保课程模板表有学年和学期字段
ALTER TABLE `sys_course_template` 
ADD COLUMN IF NOT EXISTS `academic_year` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '2024-2025' COMMENT '学年' AFTER `course_hours`;

ALTER TABLE `sys_course_template` 
ADD COLUMN IF NOT EXISTS `semester` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '第一学期' COMMENT '学期' AFTER `academic_year`;

ALTER TABLE `sys_course_template` 
ADD COLUMN IF NOT EXISTS `max_students` int NOT NULL DEFAULT 50 COMMENT '计划人数' AFTER `semester`;

-- 添加索引
ALTER TABLE `sys_course_template` 
ADD INDEX IF NOT EXISTS `idx_academic_year`(`academic_year` ASC) USING BTREE;

ALTER TABLE `sys_course_template` 
ADD INDEX IF NOT EXISTS `idx_semester`(`semester` ASC) USING BTREE;

-- 清空现有数据（如果有的话）并重新插入完整的示例数据
DELETE FROM `sys_course_template`;

-- 插入完整的课程模板数据
INSERT INTO `sys_course_template` (`template_name`, `description`, `course_hours`, `academic_year`, `semester`, `max_students`, `status`) VALUES
('Java程序设计', 'Java面向对象程序设计，包含基础语法、面向对象编程、集合框架等内容', 48, '2024-2025', '第一学期', 50, 1),
('数据库系统原理', '数据库系统的基本概念、关系模型、SQL语言、数据库设计等', 40, '2024-2025', '第一学期', 45, 1),
('计算机网络', '计算机网络的基本概念、网络协议、网络安全等', 36, '2024-2025', '第二学期', 40, 1),
('软件工程', '软件开发生命周期、需求分析、系统设计、测试等', 32, '2024-2025', '第二学期', 35, 1),
('数据结构与算法', '线性表、树、图等数据结构的实现与算法设计', 48, '2024-2025', '第一学期', 45, 1),
('操作系统原理', '操作系统的基本概念、进程管理、内存管理、文件系统等', 40, '2024-2025', '第二学期', 40, 1),
('Web开发实践', 'HTML、CSS、JavaScript、前端框架等Web开发技术', 32, '2024-2025', '第一学期', 30, 1),
('数据库实验', '数据库设计、SQL编程、数据库管理等实验', 16, '2024-2025', '第一学期', 25, 1),
('计算机组成原理', '计算机硬件系统的组成、工作原理等', 40, '2024-2025', '第一学期', 40, 1),
('人工智能导论', '人工智能的基本概念、机器学习、深度学习等', 36, '2024-2025', '第二学期', 35, 1),
('计算机网络实验', '网络协议分析、网络设备配置等实验', 16, '2024-2025', '第二学期', 20, 1),
('软件测试', '软件测试理论、测试方法、自动化测试等', 32, '2024-2025', '第二学期', 30, 1),
('移动应用开发', 'Android/iOS应用开发、跨平台开发等', 48, '2024-2025', '第一学期', 35, 1),
('机器学习', '机器学习算法、深度学习框架、项目实践', 40, '2024-2025', '第二学期', 30, 1),
('区块链技术', '区块链原理、智能合约、DApp开发', 32, '2024-2025', '第二学期', 25, 1),
('云计算基础', '云计算架构、虚拟化技术、容器技术', 36, '2024-2025', '第一学期', 40, 1),
('网络安全', '网络安全威胁、防护技术、安全评估', 40, '2024-2025', '第二学期', 35, 1),
('大数据处理', '大数据技术栈、数据挖掘、数据分析', 48, '2024-2025', '第一学期', 30, 1),
('编译原理', '编译器设计、词法分析、语法分析、代码生成', 48, '2024-2025', '第二学期', 35, 1),
('算法分析与设计', '算法复杂度分析、高级数据结构、算法优化', 40, '2024-2025', '第一学期', 40, 1),
('图形学基础', '计算机图形学原理、三维建模、渲染技术', 36, '2024-2025', '第二学期', 25, 1),
('嵌入式系统', '嵌入式硬件、实时操作系统、驱动开发', 40, '2024-2025', '第一学期', 30, 1),
('数字图像处理', '图像处理算法、计算机视觉、模式识别', 36, '2024-2025', '第二学期', 30, 1),
('分布式系统', '分布式架构、一致性算法、微服务技术', 40, '2024-2025', '第一学期', 25, 1),
('信息系统分析与设计', '需求分析、系统建模、架构设计', 32, '2024-2025', '第一学期', 35, 1),
('项目管理', '软件项目管理、敏捷开发、团队协作', 24, '2024-2025', '第二学期', 40, 1),
('数据挖掘', '数据预处理、关联规则、聚类分析、分类算法', 36, '2024-2025', '第二学期', 30, 1),
('虚拟现实技术', 'VR/AR技术原理、三维交互、沉浸式体验', 32, '2024-2025', '第一学期', 20, 1),
('物联网技术', '传感器网络、物联网协议、智能设备开发', 36, '2024-2025', '第二学期', 30, 1);

-- 验证数据
SELECT COUNT(*) as total_templates FROM `sys_course_template` WHERE `status` = 1; 